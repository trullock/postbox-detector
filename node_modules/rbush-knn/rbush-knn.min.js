!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self)["rbush-knn"]=e()}(this,(function(){"use strict";class t{constructor(t=[],n=e){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const s=t-1>>1,o=e[s];if(n(i,o)>=0)break;e[t]=o,t=s}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,s=e[t];for(;t<i;){let i=1+(t<<1),o=e[i];const h=i+1;if(h<this.length&&n(e[h],o)<0&&(i=h,o=e[h]),n(o,s)>=0)break;e[t]=o,t=i}e[t]=s}}function e(t,e){return t<e?-1:t>e?1:0}function n(t,e){return t.dist-e.dist}function i(t,e,n){var i=s(t,n.minX,n.maxX),o=s(e,n.minY,n.maxY);return i*i+o*o}function s(t,e,n){return t<e?e-t:t<=n?0:t-n}return function(e,s,o,h,r,a){for(var d,f,u,l,p=e.data,c=[],g=e.toBBox,m=new t(void 0,n);p;){for(d=0;d<p.children.length;d++)f=p.children[d],u=i(s,o,p.leaf?g(f):f),(!a||u<=a*a)&&m.push({node:f,isItem:p.leaf,dist:u});for(;m.length&&m.peek().isItem;)if(l=m.pop().node,r&&!r(l)||c.push(l),h&&c.length===h)return c;(p=m.pop())&&(p=p.node)}return c}}));
